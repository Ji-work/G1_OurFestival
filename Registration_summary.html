<!DOCTYPE html>
<html lang="th">

<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Whispers of Light | ‡∏™‡∏£‡∏∏‡∏õ‡∏Ç‡πâ‡∏≠‡∏°‡∏π‡∏•‡∏ú‡∏π‡πâ‡πÄ‡∏Ç‡πâ‡∏≤‡∏£‡πà‡∏ß‡∏°‡∏á‡∏≤‡∏ô</title>
    <link href="https://cdn.jsdelivr.net/npm/bootstrap@5.3.3/dist/css/bootstrap.min.css" rel="stylesheet">
</head>

<body>
    <header>
        <nav class="navbar navbar-expand-lg navbar-light bg-light">
            <div class="container">
                        <a class="navbar-brand fw-bold" href="index.HTML">Whispers of Light</a>
                <button class="navbar-toggler" type="button" data-bs-toggle="collapse" data-bs-target="#navbarNav">
                    <span class="navbar-toggler-icon"></span>
                </button>

                <div class="collapse navbar-collapse" id="navbarNav">
                    <ul class="navbar-nav ms-auto">
                        <li class="nav-item"><a class="nav-link" href="index.HTML">‡∏´‡∏ô‡πâ‡∏≤‡πÅ‡∏£‡∏Å</a></li>
                        <li class="nav-item"><a class="nav-link" href="booths.html">‡∏£‡πâ‡∏≤‡∏ô‡∏Ñ‡πâ‡∏≤</a></li>
                        <li class="nav-item"><a class="nav-link" href="Registration.html">‡∏•‡∏á‡∏ó‡∏∞‡πÄ‡∏ö‡∏µ‡∏¢‡∏ô</a></li>
                        <li class="nav-item"><a class="nav-link" href="Feedback.html">‡πÅ‡∏™‡∏î‡∏á‡∏Ñ‡∏ß‡∏≤‡∏°‡∏Ñ‡∏¥‡∏î‡πÄ‡∏´‡πá‡∏ô</a></li>
                    </ul>
                </div>
            </div>
        </nav>
    </header>

    <main class="container my-5">
        <h2 class="mb-4 text-center fw-bold">‡∏™‡∏£‡∏∏‡∏õ‡∏Ç‡πâ‡∏≠‡∏°‡∏π‡∏•‡∏ú‡∏π‡πâ‡πÄ‡∏Ç‡πâ‡∏≤‡πÄ‡∏¢‡∏µ‡πà‡∏¢‡∏°‡∏ä‡∏°‡∏á‡∏≤‡∏ô‡πÅ‡∏ü‡∏£‡πå‡∏ó‡∏∏‡∏Å‡∏Ñ‡∏ô</h2>

        <div id="summaryTableContainer" class="table-responsive mb-4"></div>

        <div class="text-center">
            <a href="Registration.html" class="btn btn-primary btn-lg me-2">‡∏•‡∏á‡∏ó‡∏∞‡πÄ‡∏ö‡∏µ‡∏¢‡∏ô‡πÄ‡∏û‡∏¥‡πà‡∏°‡πÄ‡∏ï‡∏¥‡∏°</a>
            <button id="clearDataBtn" class="btn btn-danger btn-lg">‡∏•‡πâ‡∏≤‡∏á‡∏Ç‡πâ‡∏≠‡∏°‡∏π‡∏•‡∏ó‡∏±‡πâ‡∏á‡∏´‡∏°‡∏î</button>
        </div>
    </main>

    <!-- Modal ‡∏™‡∏≥‡∏´‡∏£‡∏±‡∏ö‡πÅ‡∏Å‡πâ‡πÑ‡∏Ç -->
    <div class="modal fade" id="editModal" tabindex="-1" aria-labelledby="editModalLabel" aria-hidden="true">
        <div class="modal-dialog modal-lg">
            <div class="modal-content">
                <form id="editForm">
                    <div class="modal-header">
                        <h5 class="modal-title" id="editModalLabel">‡πÅ‡∏Å‡πâ‡πÑ‡∏Ç‡∏Ç‡πâ‡∏≠‡∏°‡∏π‡∏•‡∏ú‡∏π‡πâ‡πÄ‡∏Ç‡πâ‡∏≤‡∏£‡πà‡∏ß‡∏°</h5>
                        <button type="button" class="btn-close" data-bs-dismiss="modal"></button>
                    </div>
                    <div class="modal-body">
                        <div class="row g-3">
                            <div class="col-md-6">
                                <label class="form-label">‡∏ä‡∏∑‡πà‡∏≠-‡∏ô‡∏≤‡∏°‡∏™‡∏Å‡∏∏‡∏•</label>
                                <input type="text" id="editFullname" class="form-control" required>
                            </div>
                            <div class="col-md-6">
                                <label class="form-label">‡∏≠‡∏µ‡πÄ‡∏°‡∏•</label>
                                <input type="email" id="editEmail" class="form-control" required>
                            </div>
                            <div class="col-md-6">
                                <label class="form-label">‡πÇ‡∏ó‡∏£‡∏®‡∏±‡∏û‡∏ó‡πå</label>
                                <input type="tel" id="editPhone" class="form-control" required>
                            </div>
                            <div class="col-md-6">
                                <label class="form-label">‡∏õ‡∏£‡∏∞‡πÄ‡∏†‡∏ó</label>
                                <select id="editType" class="form-select" required>
                                    <option value="visitor">‡∏ú‡∏π‡πâ‡πÄ‡∏Ç‡πâ‡∏≤‡∏ä‡∏°‡∏á‡∏≤‡∏ô</option>
                                    <option value="vendor">‡πÄ‡∏à‡πâ‡∏≤‡∏Ç‡∏≠‡∏á‡∏£‡πâ‡∏≤‡∏ô‡∏Ñ‡πâ‡∏≤</option>
                                    <option value="volunteer">‡∏≠‡∏≤‡∏™‡∏≤‡∏™‡∏°‡∏±‡∏Ñ‡∏£</option>
                                </select>
                            </div>
                            <div class="col-md-6">
                                <label class="form-label">‡∏≠‡∏≤‡∏ä‡∏µ‡∏û</label>
                                <select id="editOccupation" class="form-select" required>
                                    <option value="Student">‡∏ô‡∏±‡∏Å‡πÄ‡∏£‡∏µ‡∏¢‡∏ô/‡∏ô‡∏±‡∏Å‡∏®‡∏∂‡∏Å‡∏©‡∏≤</option>
                                    <option value="Employee">‡∏û‡∏ô‡∏±‡∏Å‡∏á‡∏≤‡∏ô‡∏ö‡∏£‡∏¥‡∏©‡∏±‡∏ó</option>
                                    <option value="Self-Employed">‡πÄ‡∏à‡πâ‡∏≤‡∏Ç‡∏≠‡∏á‡∏Å‡∏¥‡∏à‡∏Å‡∏≤‡∏£</option>
                                    <option value="Other">‡∏≠‡∏∑‡πà‡∏ô ‡πÜ</option>
                                </select>
                            </div>
                            <div class="col-md-6">
                                <label class="form-label">‡∏ß‡∏±‡∏ô‡∏ó‡∏µ‡πà‡πÄ‡∏Ç‡πâ‡∏≤‡∏£‡πà‡∏ß‡∏°</label>
                                <input type="date" id="editDate" class="form-control" required>
                            </div>
                            <div class="col-12">
                                <label class="form-label">‡∏™‡∏¥‡πà‡∏á‡∏ó‡∏µ‡πà‡∏™‡∏ô‡πÉ‡∏à</label>
                                <input type="text" id="editInterests" class="form-control"
                                    placeholder="‡πÄ‡∏ä‡πà‡∏ô ‡∏î‡∏≠‡∏Å‡πÑ‡∏°‡πâ‡πÑ‡∏ü, ‡∏î‡∏ô‡∏ï‡∏£‡∏µ, ‡∏£‡πâ‡∏≤‡∏ô‡∏Ñ‡πâ‡∏≤">
                            </div>
                        </div>
                    </div>
                    <div class="modal-footer">
                        <button type="button" class="btn btn-secondary" data-bs-dismiss="modal">‡∏¢‡∏Å‡πÄ‡∏•‡∏¥‡∏Å</button>
                        <button type="submit" class="btn btn-success">‡∏ö‡∏±‡∏ô‡∏ó‡∏∂‡∏Å‡∏Å‡∏≤‡∏£‡πÅ‡∏Å‡πâ‡πÑ‡∏Ç</button>
                    </div>
                </form>
            </div>
        </div>
    </div>

    <script src="https://cdn.jsdelivr.net/npm/bootstrap@5.3.3/dist/js/bootstrap.bundle.min.js"></script>
    <script>
        const container = document.getElementById('summaryTableContainer');
        let visitors = JSON.parse(localStorage.getItem('fairVisitors')) || [];
        let currentEditIndex = null;

        function renderTable() {
            if (visitors.length === 0) {
                container.innerHTML = '<div class="alert alert-warning text-center"><strong>‡∏¢‡∏±‡∏á‡πÑ‡∏°‡πà‡∏°‡∏µ‡∏ú‡∏π‡πâ‡πÄ‡∏¢‡∏µ‡πà‡∏¢‡∏°‡∏ä‡∏°‡∏•‡∏á‡∏ó‡∏∞‡πÄ‡∏ö‡∏µ‡∏¢‡∏ô!</strong></div>';
                return;
            }

            let tableHTML = `
                <table class="table table-striped table-hover align-middle">
                    <thead class="table-dark text-center">
                        <tr>
                            <th>‡∏•‡∏≥‡∏î‡∏±‡∏ö</th>
                            <th>‡∏ä‡∏∑‡πà‡∏≠-‡∏ô‡∏≤‡∏°‡∏™‡∏Å‡∏∏‡∏•</th>
                            <th>‡∏≠‡∏µ‡πÄ‡∏°‡∏•</th>
                            <th>‡πÇ‡∏ó‡∏£‡∏®‡∏±‡∏û‡∏ó‡πå</th>
                            <th>‡∏õ‡∏£‡∏∞‡πÄ‡∏†‡∏ó</th>
                            <th>‡∏≠‡∏≤‡∏ä‡∏µ‡∏û</th>
                            <th>‡∏ß‡∏±‡∏ô‡∏ó‡∏µ‡πà</th>
                            <th>‡∏Ñ‡∏ß‡∏≤‡∏°‡∏™‡∏ô‡πÉ‡∏à</th>
                            <th>‡πÄ‡∏ß‡∏•‡∏≤</th>
                            <th>‡∏à‡∏±‡∏î‡∏Å‡∏≤‡∏£</th>
                        </tr>
                    </thead>
                    <tbody>
            `;

            visitors.forEach((v, i) => {
                tableHTML += `
                    <tr class="text-center">
                        <td>${i + 1}</td>
                        <td>${v.fullname}</td>
                        <td>${v.email}</td>
                        <td>${v.phone}</td>
                        <td>${v.participantType}</td>
                        <td>${v.occupation}</td>
                        <td>${v.date}</td>
                        <td>${v.interests || '-'}</td>
                        <td>${v.timestamp}</td>
                        <td>
                            <button class="btn btn-sm btn-warning me-1" onclick="editVisitor(${i})">‡πÅ‡∏Å‡πâ‡πÑ‡∏Ç</button>
                            <button class="btn btn-sm btn-danger" onclick="deleteVisitor(${i})">‡∏•‡∏ö</button>
                        </td>
                    </tr>`;
            });

            tableHTML += `</tbody></table>`;
            container.innerHTML = tableHTML;
        }

        // üßπ ‡∏•‡πâ‡∏≤‡∏á‡∏Ç‡πâ‡∏≠‡∏°‡∏π‡∏•‡∏ó‡∏±‡πâ‡∏á‡∏´‡∏°‡∏î
        document.getElementById("clearDataBtn").addEventListener("click", () => {
            if (confirm("‡∏Ñ‡∏∏‡∏ì‡πÅ‡∏ô‡πà‡πÉ‡∏à‡∏´‡∏£‡∏∑‡∏≠‡πÑ‡∏°‡πà‡∏ó‡∏µ‡πà‡∏à‡∏∞‡∏•‡πâ‡∏≤‡∏á‡∏Ç‡πâ‡∏≠‡∏°‡∏π‡∏•‡∏ó‡∏±‡πâ‡∏á‡∏´‡∏°‡∏î?")) {
                localStorage.removeItem("fairVisitors");
                visitors = [];
                renderTable();
            }
        });

        // ‚ùå ‡∏•‡∏ö‡∏£‡∏≤‡∏¢‡∏Ñ‡∏ô
        function deleteVisitor(index) {
            if (confirm(`‡∏ï‡πâ‡∏≠‡∏á‡∏Å‡∏≤‡∏£‡∏•‡∏ö‡∏Ç‡πâ‡∏≠‡∏°‡∏π‡∏•‡∏Ç‡∏≠‡∏á ${visitors[index].fullname} ‡πÉ‡∏ä‡πà‡∏´‡∏£‡∏∑‡∏≠‡πÑ‡∏°‡πà?`)) {
                visitors.splice(index, 1);
                localStorage.setItem('fairVisitors', JSON.stringify(visitors));
                renderTable();
            }
        }

        // ‚úèÔ∏è ‡πÅ‡∏Å‡πâ‡πÑ‡∏Ç
        function editVisitor(index) {
            currentEditIndex = index;
            const v = visitors[index];
            document.getElementById('editFullname').value = v.fullname;
            document.getElementById('editEmail').value = v.email;
            document.getElementById('editPhone').value = v.phone;
            document.getElementById('editType').value = v.participantType;
            document.getElementById('editOccupation').value = v.occupation;
            document.getElementById('editDate').value = v.date;
            document.getElementById('editInterests').value = v.interests || '';

            const modal = new bootstrap.Modal(document.getElementById('editModal'));
            modal.show();
        }

        // üíæ ‡∏ö‡∏±‡∏ô‡∏ó‡∏∂‡∏Å‡∏Å‡∏≤‡∏£‡πÅ‡∏Å‡πâ‡πÑ‡∏Ç
        document.getElementById('editForm').addEventListener('submit', (e) => {
            e.preventDefault();

            const updated = {
                ...visitors[currentEditIndex],
                fullname: document.getElementById('editFullname').value,
                email: document.getElementById('editEmail').value,
                phone: document.getElementById('editPhone').value,
                participantType: document.getElementById('editType').value,
                occupation: document.getElementById('editOccupation').value,
                date: document.getElementById('editDate').value,
                interests: document.getElementById('editInterests').value
            };

            visitors[currentEditIndex] = updated;
            localStorage.setItem('fairVisitors', JSON.stringify(visitors));
            renderTable();

            const modal = bootstrap.Modal.getInstance(document.getElementById('editModal'));
            modal.hide();
        });

        // ‡πÇ‡∏´‡∏•‡∏î‡∏Ñ‡∏£‡∏±‡πâ‡∏á‡πÅ‡∏£‡∏Å
        renderTable();

        // ‡πÉ‡∏´‡πâ‡∏ü‡∏±‡∏á‡∏Å‡πå‡∏ä‡∏±‡∏ô‡∏•‡∏ö/‡πÅ‡∏Å‡πâ‡πÑ‡∏Ç‡πÄ‡∏Ç‡πâ‡∏≤‡∏ñ‡∏∂‡∏á‡πÑ‡∏î‡πâ‡∏à‡∏≤‡∏Å‡∏õ‡∏∏‡πà‡∏°
        window.deleteVisitor = deleteVisitor;
        window.editVisitor = editVisitor;
    </script>
</body>
</html>
